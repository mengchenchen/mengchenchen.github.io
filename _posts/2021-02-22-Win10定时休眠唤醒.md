---
layout: post
title: Win10å®šæ—¶ä¼‘çœ å’Œå”¤é†’
catalog: true
tag: Win10
---

æ‰§è¡Œåœºæ™¯ï¼š

æ—©ä¸Š 8 ç‚¹ï¼Œè‡ªåŠ¨å”¤é†’ç”µè„‘ï¼Œç™»å½•å¾®ä¿¡ã€é’‰é’‰ï¼›

ä¸‹åˆ 6 ç‚¹ï¼Œå¼¹çª—è¯¢é—®æ˜¯å¦ä¼‘çœ ï¼Œç¡®å®šåï¼Œæ€æ‰å¾®ä¿¡ã€é’‰é’‰è¿›ç¨‹ï¼Œè¿›å…¥ä¼‘çœ çŠ¶æ€ã€‚

å®Œæ•´çš„Windowså®šæ—¶ä¼‘çœ /å”¤é†’æµç¨‹ï¼Œé€‚ç”¨äººç¾¤åœºæ™¯ä¸ºã€995å¸¸è§„ç¤¾ç•œã€

## ä¼‘çœ 

### 1ã€å¼€å¯ä¼‘çœ é€‰é¡¹

ğŸ‘‡ è®¾ç½® cmd
```cmd
# æŸ¥è¯¢ç”µæºé€‰é¡¹
powercfg /a
# å¼€å¯ä¼‘çœ é€‰é¡¹
powercfg -h on
```

### 2ã€ æ‰“å¼€ä¼‘çœ èœå•

ä¾æ¬¡æ‰“å¼€å¹¶å‹¾é€‰ï¼š

> æ§åˆ¶é¢æ¿\ç¡¬ä»¶å’Œå£°éŸ³\ç”µæºé€‰é¡¹\ç³»ç»Ÿè®¾ç½®\æ›´æ”¹å½“å‰ä¸å¯ç”¨çš„è®¾ç½®\ä¼‘çœ 

### 3ã€é…ç½®ä¼‘çœ è„šæœ¬

é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ä½ç½®ï¼Œæ¯”å¦‚ `D:\shutdown`

å³é”®ç©ºç™½å¤„æ–°å»ºæ–‡æ¡£ï¼Œå°†ä»¥ä¸‹å†…å®¹å¤åˆ¶ç²˜è´´

å¦å­˜ä¸º `shutdownh.vbs`

**é€‰æ‹©æ ¼å¼ä¸º ANSIï¼Œå¦åˆ™ä¸èƒ½æ­£å¸¸ä½¿ç”¨**

ğŸ‘‡ è„šæœ¬

```vbscript
' è·å–å½“å‰ç¨‹åºæ‰€åœ¨çš„æ–‡ä»¶ä½ç½®
Dim strWorkDir
strWorkDir = Left(WScript.ScriptFullName,instrrev(WScript.ScriptFullName,"\")-1)

' åŠ è½½é…ç½®æ–‡ä»¶
dim fso
config = strWorkDir & "\kill.txtc"

' è®¾ç½®æ€æ‰è¿›ç¨‹
dim items
set fso = CreateObject("Scripting.FileSystemObject")
if fso.FileExists(config) then
    set f = fso.OpenTextFile(config, 1, false)
	items = f.ReadLine()
	f.Close()
	set f = nothing
	set fso = nothing
else
	If MsgBox("åœ¨ä¼‘çœ æ—¶éœ€è¦æŒ‡å®šå…³é—­è¿›ç¨‹ä¹ˆï¼Ÿ",vbOKCancel) = VbOk Then
		items = InputBox("è¾“å…¥ä½ ä¼‘çœ æ—¶éœ€è¦æ€æ‰çš„è¿›ç¨‹ï¼Œå¤šä¸ªè¿›ç¨‹ä½¿ç”¨ç©ºæ ¼åˆ†å¼€")
		set f = fso.CreateTextFile(config, true)
		f.Write(items)
		f.Close()
		set f = nothing
		set fso = nothing
	End If
End If

' å…³æœºæ“ä½œ
Set WshShell = CreateObject("Wscript.Shell")
w = WshShell.Popup("ä¸‹ç­äº†ï¼Œéœ€è¦ä¼‘çœ å—ï¼Ÿä¸æ“ä½œ10åˆ†é’Ÿåè‡ªåŠ¨å…³æœº", 600, "ä¸‹ç­æé†’",vbOKCancel)
If w = vbOk Or w <> vbCancel Then
    If Not IsEmpty(items) then
        ' åƒä¸‡ä¸è¦åœ¨å‰é¢åŠ  dimï¼Œdim åªèƒ½ç”¨æ¥å£°æ˜ä¸èƒ½èµ‹å€¼
        ' dim process = split(items," ")
        process = split(items," ")
        for each item in process
            WshShell.run "taskkill /f /im " & item, 0
        next
    End If
	WshShell.run "shutdown -h",0
End If
```

### 4ã€é…ç½®å®šæ—¶ä»»åŠ¡

è®¾ç½®ä¼‘çœ çš„æ—¶é—´æ¯å¤©ä¸‹åˆçš„5:30ï¼ˆæŒ‰ç…§ä½ çš„éœ€æ±‚æ—¶é—´è‡ªè¡Œä¿®æ”¹ï¼‰ï¼Œæ‰§è¡Œç¨‹åº `D:\shutdown\shutdownh.vbs`ã€‚

ğŸ‘‡ cmd å‘½ä»¤åˆ›å»º

```cmd
schtasks.exe /create /tn "è‡ªåŠ¨ä¼‘çœ " /ru SYSTEM /sc daily /tr "D:\shutdown\shutdownh.vbs" /st 17:30
```

### 5ã€å…³äºæ€æ­»è¿›ç¨‹

è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆä¼‘çœ è¦æ€æ‰æŸäº›è¿›ç¨‹ï¼Œç¬¬ä¸€æœ‰äº›è¿›ç¨‹ä¼šåœ¨æŒ‚èµ·åæŒç»­åƒå†…å­˜å¯¼è‡´ç³»ç»Ÿå˜çš„å¡é¡¿ï¼›ç¬¬äºŒæœ‰äº›è¿›ç¨‹ä¸€ç›´æŒ‚åœ¨åå°ä¸å®‰å…¨ï¼Œæ¯”å¦‚å¾®ä¿¡/qqç­‰ç­‰ã€‚

ç¬¬ä¸€æ¬¡è¯¢é—®çš„æ—¶å€™æŠŠè¦æ€æ­»çš„è¿›ç¨‹å†™è¿›å»ï¼Œä¼‘çœ çš„æ—¶å€™ä¼šè‡ªåŠ¨å…³é—­çš„ï¼Œè¿™é‡Œä¸¾äº†ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„ä¾‹å­

* WeChat.exe 
* WeChatApp.exe 
* Qq.exe 
* DingTalk.exe

ç”µè„‘ä¼‘çœ å…¶ä»–çš„ç¨‹åºä¸ä¼šå…³é—­ï¼Œä½†æ˜¯å¾®ä¿¡ã€é’‰é’‰æ˜¯å¿…é¡»è¦å…³çš„ï¼Œä¸ºäº†å®‰å…¨èµ·è§ã€‚

```cmd
# æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨
tasklist
# æŸ¥çœ‹è¿›ç¨‹æ­£åœ¨è¯•ç”¨çš„æ¨¡å—
tasklist /m
# æŸ¥è¯¢æŒ‡å®šçš„dllæ–‡ä»¶æ­£åœ¨è¢«è°ä½¿ç”¨
tasklist /m:XXX.dll
```

ğŸ‘‡ æ‰‹åŠ¨åˆ›å»º

æˆ‘çš„ç”µè„‘\æ­¤ç”µè„‘\å³é”®ç®¡ç†\åˆ›å»ºè®¡åˆ’ä»»åŠ¡

## å”¤é†’

è‡ªåŠ¨å”¤é†’é…åˆå·¥å…· `WakeupOnStandBy`ï¼Œ[ç‚¹å‡»ä¸‹è½½](https://wwx.lanzoui.com/iz4yYlzadla)


é…ç½®å¦‚ ğŸ‘‡ å›¾


![img](https://gitee.com/brymg/images/raw/master/blog/20210222-111125-0852.png)

